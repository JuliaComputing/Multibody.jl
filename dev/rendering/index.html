<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>3D rendering · Multibody.jl</title><meta name="title" content="3D rendering · Multibody.jl"/><meta property="og:title" content="3D rendering · Multibody.jl"/><meta property="twitter:title" content="3D rendering · Multibody.jl"/><meta name="description" content="Documentation for Multibody.jl."/><meta property="og:description" content="Documentation for Multibody.jl."/><meta property="twitter:description" content="Documentation for Multibody.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">Multibody.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../examples/pendulum/">Getting started: Pendulum</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../examples/spring_damper_system/">Spring-damper system</a></li><li><a class="tocitem" href="../examples/spring_mass_system/">Spring-mass system</a></li><li><a class="tocitem" href="../examples/three_springs/">Three springs (series forces)</a></li><li><a class="tocitem" href="../examples/sensors/">Sensors</a></li><li><a class="tocitem" href="../examples/spherical_pendulum/">Spherical pendulum</a></li><li><a class="tocitem" href="../examples/gearbox/">Gearbox</a></li><li><a class="tocitem" href="../examples/free_motion/">Free motions</a></li><li><a class="tocitem" href="../examples/prescribed_pose/">Prescribed motions</a></li><li><a class="tocitem" href="../examples/kinematic_loops/">Kinematic loops</a></li><li><a class="tocitem" href="../examples/robot/">Industrial robot</a></li><li><a class="tocitem" href="../examples/ropes_and_cables/">Ropes, cables and chains</a></li><li><a class="tocitem" href="../examples/swing/">Swing</a></li><li><a class="tocitem" href="../examples/space/">Bodies in space</a></li><li><a class="tocitem" href="../examples/gyroscopic_effects/">Gyroscopic effects</a></li><li><a class="tocitem" href="../examples/wheel/">Wheels</a></li><li><a class="tocitem" href="../examples/suspension/">Suspension systems</a></li><li><a class="tocitem" href="../examples/quad/">Quadrotor with cable-suspended load</a></li></ul></li><li><span class="tocitem">Components</span><ul><li><a class="tocitem" href="../frames/">Frames</a></li><li><a class="tocitem" href="../joints/">Joints</a></li><li><a class="tocitem" href="../components/">Components</a></li><li><a class="tocitem" href="../forces/">Forces</a></li><li><a class="tocitem" href="../sensors/">Sensors</a></li><li><a class="tocitem" href="../trajectory_planning/">Trajectory planning</a></li><li><a class="tocitem" href="../interfaces/">Interfaces</a></li></ul></li><li><a class="tocitem" href="../rotations/">Rotations and orientation</a></li><li class="is-active"><a class="tocitem" href>3D rendering</a><ul class="internal"><li><a class="tocitem" href="#Colors"><span>Colors</span></a></li><li><a class="tocitem" href="#Rendering-the-world-frame"><span>Rendering the world frame</span></a></li><li><a class="tocitem" href="#Tracing-the-path-of-a-frame-in-3D-visualizations"><span>Tracing the path of a frame in 3D visualizations</span></a></li><li><a class="tocitem" href="#Camera-controls"><span>Camera controls</span></a></li><li><a class="tocitem" href="#Rendering-API"><span>Rendering API</span></a></li></ul></li><li><a class="tocitem" href="../urdf/">URDF import</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>3D rendering</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>3D rendering</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaComputing/Multibody.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="3D-rendering-and-animations"><a class="docs-heading-anchor" href="#3D-rendering-and-animations">3D rendering and animations</a><a id="3D-rendering-and-animations-1"></a><a class="docs-heading-anchor-permalink" href="#3D-rendering-and-animations" title="Permalink"></a></h1><p>Multibody.jl has an automatic 3D-rendering feature that draws a mechanism in 3D. This can be used to create animations of the mechanism&#39;s motion from a solution trajectory, as well as to create interactive applications where the evolution of time can be controlled by the user.</p><p>The functionality requires the user to install and load one of the <a href="https://docs.makie.org/">Makie backend packages</a>, e.g., </p><pre><code class="language-julia hljs">using GLMakie # Preferred</code></pre><p>or </p><pre><code class="language-julia hljs">using CairoMakie</code></pre><div class="admonition is-info"><header class="admonition-header">Backend choice</header><div class="admonition-body"><p>GLMakie and WGLMakie produce much nicer-looking animations and are also significantly faster than CairoMakie. CairoMakie may be used to produce the graphics in some web environments if constraints imposed by the web environment do not allow any of the GL alternatives. CairoMakie struggles with the Z-order of drawn objects, sometimes making bodies that should have been visible hidden behind bodies that are further back in the scene.</p></div></div><p>After that, the <a href="#Multibody.render"><code>render</code></a> function is the main entry point to create 3D renderings. This function has the following methods:</p><ul><li><code>render(model, prob::ODEProblem)</code>: this method creates an <em>interactive</em> figure corresponding to the mechanisms configuration at the specified initial condition.</li><li><code>render(model, solution)</code>: this method creates an <em>animation</em> corresponding to the mechanisms evolution in a simulation trajectory.</li><li><code>scene, time = render(model, solution, t::Real)</code>: this method opens an <em>interactive</em> window with the mechanism in the configuration corresponding to the time <code>t</code>. Display <code>scene</code> to display the interactive window, and change the time by either dragging the slider in the window, or write to the observable <code>time[] = new_time</code>.</li></ul><h2 id="Colors"><a class="docs-heading-anchor" href="#Colors">Colors</a><a id="Colors-1"></a><a class="docs-heading-anchor-permalink" href="#Colors" title="Permalink"></a></h2><p>Many components allows the user to select with which color it is rendered. This choice is made by providing a 4-element array with color values in the order (RGBA), where each value is between 0 and 1. The last value is the alpha channel which determines the opacity, i.e., 1 is opaque and 0 is invisible.</p><h2 id="Rendering-the-world-frame"><a class="docs-heading-anchor" href="#Rendering-the-world-frame">Rendering the world frame</a><a id="Rendering-the-world-frame-1"></a><a class="docs-heading-anchor-permalink" href="#Rendering-the-world-frame" title="Permalink"></a></h2><p>The display of the world frame can be turned off by setting <code>world.render =&gt; false</code> in the variable map.</p><h2 id="Tracing-the-path-of-a-frame-in-3D-visualizations"><a class="docs-heading-anchor" href="#Tracing-the-path-of-a-frame-in-3D-visualizations">Tracing the path of a frame in 3D visualizations</a><a id="Tracing-the-path-of-a-frame-in-3D-visualizations-1"></a><a class="docs-heading-anchor-permalink" href="#Tracing-the-path-of-a-frame-in-3D-visualizations" title="Permalink"></a></h2><p>The path that a frame traces out during simulation can be visualized by passing a vector of frames to the <code>render</code> function using the <code>traces</code> keyword, e.g., <code>render(..., traces=[frame1, frame2])</code>. See the Furuta-pendulum demonstration <a href="../examples/pendulum/#Going-3D">Going 3D</a> for an example of this.</p><h2 id="Camera-controls"><a class="docs-heading-anchor" href="#Camera-controls">Camera controls</a><a id="Camera-controls-1"></a><a class="docs-heading-anchor-permalink" href="#Camera-controls" title="Permalink"></a></h2><p>The camera controls are inherited from Makie, <a href="https://docs.makie.org/stable/explanations/cameras#3D-Camera">see their documentation for more information</a>. Of particular interest may be the keyboard shortcuts <code>x, y, z</code>, by holding one of these keys and dragging the mouse, the camera will rotate around the corresponding axis. Use keyword argument <code>show_axis = true</code> to function <code>render</code> or pass parameter <code>world.render =&gt; true</code> to <code>ODEProblem</code> to display plot axes and/or world axes in the plot.</p><h2 id="Rendering-API"><a class="docs-heading-anchor" href="#Rendering-API">Rendering API</a><a id="Rendering-API-1"></a><a class="docs-heading-anchor-permalink" href="#Rendering-API" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Multibody.render" href="#Multibody.render"><code>Multibody.render</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">scene       = render(model, prob)
scene, time = render(model, sol, t::Real; framerate = 30, traces = [])
path        = render(model, sol, timevec = range(sol.t[1], sol.t[end], step = 1 / framerate); framerate = 30, timescale=1, display=false, loop=1)</code></pre><p>Create a 3D animation of a multibody system</p><p><strong>Arguments:</strong></p><ul><li><code>model</code>: The <em>unsimplified</em> multibody model, i.e., this is the model <em>before</em> any call to <code>structural_simplify</code>.</li><li><code>prob</code>: If an <code>ODEProblem</code> is passed, a static rendering of the system at the initial condition is generated.</li><li><code>sol</code>: If an <code>ODESolution</code> produced by simulating the system using <code>solve</code> is passed, an animation or dynamic rendering of the system is generated.</li><li><code>t</code>: If a single number <code>t</code> is provided, the mechanism at this time is rendered and a scene is returned together with the time as an <code>Observable</code>. Modify <code>time[] = new_time</code> to change the rendering.</li><li><code>timevec</code>: If a vector of times is provided, an animation is created and the path to the file on disk is returned.</li><li><code>framerate</code>: Number of frames per second.</li><li><code>timescale</code>: Scaling of the time vector. This argument can be made to speed up animations (<code>timescale &lt; 1</code>) or slow them down (<code>timescale &gt; 1</code>). A value of <code>timescale = 2</code> will be 2x slower than real time.</li><li><code>loop</code>: The animation will be looped this many times. Please note: looping the animation using this argument is only recommended when <code>display = true</code> for camera manipulation purposes. When the camera is not manipulated, looping the animation by other means is recommended to avoid an increase in the file size.</li><li><code>filename</code> controls the name and the file type of the resulting animation</li><li><code>traces</code>: An optional array of frames to show the trace of.</li><li><code>show_axis = false</code>: Whether or not to show the plot axes, including background grid.</li></ul><p><strong>Camera control</strong></p><p>The following keyword arguments are available to control the camera pose:</p><ul><li><code>x = 2</code></li><li><code>y = 0.5</code></li><li><code>z = 2</code></li><li><code>lookat = [0,0,0]</code>: a three-vector of coordinates indicating the point at which the camera looks.</li><li><code>up = [0,1,0]</code>: A vector indicating the direction that is up.</li><li><code>display</code>: if <code>true</code>, the figure will be displayed during the recording process and time will advance in real-time. This allows the user to manipulate the camera options using the mouse during the recording.</li></ul><p>See also <a href="@ref"><code>loop_render</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaComputing/Multibody.jl/blob/19420b8520ea07ab5912e8b6172380ee6ab12294/src/Multibody.jl#L101-L131">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Multibody.render!" href="#Multibody.render!"><code>Multibody.render!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">did_render::Bool = render!(scene, ::typeof(ComponentConstructor), sys, sol, t)</code></pre><p>Each component that can be rendered must have a <code>render!</code> method. This method is called by <code>render</code> for each component in the system.</p><p>This method is responsible for drawing the component onto the scene the way it&#39;s supposed to look at time <code>t</code> in the solution <code>sol</code>. <code>t</code> is an Observable. It&#39;s recommended to follow the pattern</p><pre><code class="language-julia hljs">thing = @lift begin
    acces relevant coordinates from sol at time t
    create a geometric object that can be rendered
end
mesh!(scene, thing; style...)</code></pre><p><strong>Returns</strong></p><p>A boolean indicating whether or not the component performed any rendering. Typically, all custom methods of this function should return <code>true</code>, while the default fallback method is the only one returning false.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaComputing/Multibody.jl/blob/19420b8520ea07ab5912e8b6172380ee6ab12294/src/Multibody.jl#L141-L158">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../rotations/">« Rotations and orientation</a><a class="docs-footer-nextpage" href="../urdf/">URDF import »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Monday 7 October 2024 13:59">Monday 7 October 2024</span>. Using Julia version 1.10.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
