<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Rotations and orientation · Multibody.jl</title><meta name="title" content="Rotations and orientation · Multibody.jl"/><meta property="og:title" content="Rotations and orientation · Multibody.jl"/><meta property="twitter:title" content="Rotations and orientation · Multibody.jl"/><meta name="description" content="Documentation for Multibody.jl."/><meta property="og:description" content="Documentation for Multibody.jl."/><meta property="twitter:description" content="Documentation for Multibody.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">Multibody.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../examples/pendulum/">Getting started: Pendulum</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../examples/spring_damper_system/">Spring-damper system</a></li><li><a class="tocitem" href="../examples/spring_mass_system/">Spring-mass system</a></li><li><a class="tocitem" href="../examples/three_springs/">Three springs (series forces)</a></li><li><a class="tocitem" href="../examples/sensors/">Sensors</a></li><li><a class="tocitem" href="../examples/spherical_pendulum/">Spherical pendulum</a></li><li><a class="tocitem" href="../examples/gearbox/">Gearbox</a></li><li><a class="tocitem" href="../examples/free_motion/">Free motions</a></li><li><a class="tocitem" href="../examples/kinematic_loops/">Kinematic loops</a></li><li><a class="tocitem" href="../examples/robot/">Industrial robot</a></li><li><a class="tocitem" href="../examples/ropes_and_cables/">Ropes, cables and chains</a></li><li><a class="tocitem" href="../examples/swing/">Swing</a></li><li><a class="tocitem" href="../examples/space/">Bodies in space</a></li><li><a class="tocitem" href="../examples/gyroscopic_effects/">Gyroscopic effects</a></li><li><a class="tocitem" href="../examples/wheel/">Wheels</a></li><li><a class="tocitem" href="../examples/suspension/">Suspension systems</a></li><li><a class="tocitem" href="../examples/quad/">Quadrotor with cable-suspended load</a></li></ul></li><li class="is-active"><a class="tocitem" href>Rotations and orientation</a><ul class="internal"><li><a class="tocitem" href="#Euler-angles"><span>Euler angles</span></a></li><li><a class="tocitem" href="#Quaternions"><span>Quaternions</span></a></li><li><a class="tocitem" href="#Rotation-matrices"><span>Rotation matrices</span></a></li><li><a class="tocitem" href="#Conversion-between-orientation-formats"><span>Conversion between orientation formats</span></a></li><li><a class="tocitem" href="#Conventions-for-modeling"><span>Conventions for modeling</span></a></li><li><a class="tocitem" href="#Orientation-API"><span>Orientation API</span></a></li></ul></li><li><a class="tocitem" href="../rendering/">3D rendering</a></li><li><a class="tocitem" href="../urdf/">URDF import</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Rotations and orientation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Rotations and orientation</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaComputing/Multibody.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Working-with-orientation-and-rotation"><a class="docs-heading-anchor" href="#Working-with-orientation-and-rotation">Working with orientation and rotation</a><a id="Working-with-orientation-and-rotation-1"></a><a class="docs-heading-anchor-permalink" href="#Working-with-orientation-and-rotation" title="Permalink"></a></h1><p>Orientations and rotations in 3D can be represented in multiple different ways. Components which (may) have a 3D angular state, such as <a href="../#Multibody.Body-Tuple{}"><code>Body</code></a>, <a href="../#Multibody.Spherical-Tuple{}"><code>Spherical</code></a> and <a href="../#Multibody.FreeMotion-Tuple{}"><code>FreeMotion</code></a>, offer the user to select the orientation representation, either Euler angles or quaternions.</p><h2 id="Euler-angles"><a class="docs-heading-anchor" href="#Euler-angles">Euler angles</a><a id="Euler-angles-1"></a><a class="docs-heading-anchor-permalink" href="#Euler-angles" title="Permalink"></a></h2><p><a href="https://en.wikipedia.org/wiki/Euler_angles">Euler angles</a> represent orientation using rotations around three axes, and thus uses three numbers to represent the orientation. The benefit of this representation is that it is minimal (only three numbers used), but the drawback is that any 3-number orientation representation suffers from a kinematic singularity. This representation is beneficial when you know that the singularity will not come into play in your simulation.</p><p>Most components that may use Euler angles also allow you to select the sequence of axis around which to perform the rotations, e.g., <code>sequence = [1,2,3]</code> performs rotations around <span>$x$</span> first, then <span>$y$</span> and <span>$z$</span>.</p><h2 id="Quaternions"><a class="docs-heading-anchor" href="#Quaternions">Quaternions</a><a id="Quaternions-1"></a><a class="docs-heading-anchor-permalink" href="#Quaternions" title="Permalink"></a></h2><p>A <a href="https://en.wikipedia.org/wiki/Quaternion">quaternion</a> represents an orientation using 4 numbers. This is a non-minimal representation, but in return it is also singularity free. Multibody.jl uses <em>non-unit quaternions</em><sup class="footnote-reference"><a id="citeref-quat" href="#footnote-quat">[quat]</a></sup> to represent orientation when <code>quat = true</code> is provided to components that support this option. The convention used for quaternions is <span>$[s, v_1, v_2, v_3]$</span>, sometimes also referred to as <span>$[w, i, j, k]$</span>, i.e., the real/scalar part comes first, followed by the three imaginary numbers. When quaternions are used, state variables <code>Q̂</code> denote non-unit quaternions, while normalized unit quaternions are available as observable variables <code>Q</code>. The use of non-unit quaternions allows Multibody to integrate rotations without using dynamic state selection or introducing algebraic equations. </p><p>Multibody.jl depends on <a href="https://github.com/JuliaGeometry/Rotations.jl">Rotations.jl</a> which in turn uses <a href="https://github.com/JuliaGeometry/Quaternions.jl">Quaternions.jl</a> for quaternion computations. If you manually create quaternions using these packages, you may convert them to a vector to provide, e.g., initial conditions, using <code>Rotations.params(Q)</code> (see <a href="#Conversion-between-orientation-formats">Conversion between orientation formats</a> below).</p><h3 id="Examples-using-quaternions"><a class="docs-heading-anchor" href="#Examples-using-quaternions">Examples using quaternions</a><a id="Examples-using-quaternions-1"></a><a class="docs-heading-anchor-permalink" href="#Examples-using-quaternions" title="Permalink"></a></h3><ul><li><a href="../examples/free_motion/#Free-motions">Free motions</a> (second example on the page)</li><li><a href="../examples/three_springs/#Three-springs">Three springs</a></li><li><a href="../examples/space/#Bodies-in-space">Bodies in space</a> (may use, see comment)</li></ul><h2 id="Rotation-matrices"><a class="docs-heading-anchor" href="#Rotation-matrices">Rotation matrices</a><a id="Rotation-matrices-1"></a><a class="docs-heading-anchor-permalink" href="#Rotation-matrices" title="Permalink"></a></h2><p>Rotation matrices represent orientation using a <span>$3\times 3$</span> matrix <span>$\in SO(3)$</span>. These are used in the equations of multibody components and connectors, but should for the most part be invisible to the user. In particular, they should never appear as state variables after simplification. </p><h2 id="Conversion-between-orientation-formats"><a class="docs-heading-anchor" href="#Conversion-between-orientation-formats">Conversion between orientation formats</a><a id="Conversion-between-orientation-formats-1"></a><a class="docs-heading-anchor-permalink" href="#Conversion-between-orientation-formats" title="Permalink"></a></h2><p>You may convert between different representations of orientation using the appropriate constructors from Rotations.jl, for example:</p><pre><code class="language-julia hljs">using Multibody.Rotations
using Multibody.Rotations: params
using Multibody.Rotations.Quaternions
using LinearAlgebra

R = RotMatrix{3}(I(3))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">3×3 RotMatrix3{Bool} with indices SOneTo(3)×SOneTo(3):
 1  0  0
 0  1  0
 0  0  1</code></pre><pre><code class="language-julia hljs"># Convert R to a quaternion
Q = QuatRotation(R)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">3×3 QuatRotation{Float64} with indices SOneTo(3)×SOneTo(3)(QuaternionF64(1.0, 0.0, 0.0, 0.0)):
 1.0  0.0  0.0
 0.0  1.0  0.0
 0.0  0.0  1.0</code></pre><pre><code class="language-julia hljs"># Convert Q to a 4-vector
Qvec = params(Q)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">4-element StaticArraysCore.SVector{4, Float64} with indices SOneTo(4):
 1.0
 0.0
 0.0
 0.0</code></pre><pre><code class="language-julia hljs"># Convert R to Euler angles in the sequence XYZ
E = RotXYZ(R)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">3×3 RotXYZ{Float64} with indices SOneTo(3)×SOneTo(3)(0.0, 0.0, 0.0):
 1.0  -0.0   0.0
 0.0   1.0  -0.0
 0.0   0.0   1.0</code></pre><pre><code class="language-julia hljs"># Convert E to a 3-vector
Evec = params(E)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">3-element StaticArraysCore.SVector{3, Float64} with indices SOneTo(3):
 0.0
 0.0
 0.0</code></pre><pre><code class="language-julia hljs">rotation_axis(R), rotation_angle(R) # Get an axis-angle representation</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">([1.0, 0.0, 0.0], 0.0)</code></pre><h2 id="Conventions-for-modeling"><a class="docs-heading-anchor" href="#Conventions-for-modeling">Conventions for modeling</a><a id="Conventions-for-modeling-1"></a><a class="docs-heading-anchor-permalink" href="#Conventions-for-modeling" title="Permalink"></a></h2><p>See <a href="../examples/pendulum/#Orientations-and-directions">Orientations and directions</a></p><h2 id="Orientation-API"><a class="docs-heading-anchor" href="#Orientation-API">Orientation API</a><a id="Orientation-API-1"></a><a class="docs-heading-anchor-permalink" href="#Orientation-API" title="Permalink"></a></h2><p>See <a href="../#Orientation-utilities">Orientation utilities</a></p><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-quat"><a class="tag is-link" href="#citeref-quat">quat</a>&quot;Integrating Rotations using Non-Unit Quaternions&quot;, Caleb Rucker, https://par.nsf.gov/servlets/purl/10097724</li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../examples/quad/">« Quadrotor with cable-suspended load</a><a class="docs-footer-nextpage" href="../rendering/">3D rendering »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Monday 23 September 2024 16:38">Monday 23 September 2024</span>. Using Julia version 1.10.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
